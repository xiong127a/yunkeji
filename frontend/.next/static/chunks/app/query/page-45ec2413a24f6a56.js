(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[25],{78929:function(e,t,s){Promise.resolve().then(s.bind(s,22173))},65126:function(e,t,s){"use strict";var n=s(54829),a=s(11490);t.Z=new class{async login(e,t){let s=await this.axiosInstance.post("/auth/login",{username:e,password:t});return s.data}async register(e,t,s){let n=await this.axiosInstance.post("/auth/register",{username:e,email:t,password:s});return n.data}async submitRealEstateQuery(e){let t=await this.axiosInstance.post("/user/real-estate/query",e);return t.data}async submitRealEstateQueryWithFiles(e){let t=await this.axiosInstance.post("/user/real-estate/query-with-files",e,{headers:{"Content-Type":"multipart/form-data"}});return t.data}async queryRealEstateResult(e){let t=await this.axiosInstance.get("/user/real-estate/result/".concat(e));return t.data}async getUserQueryRecords(){let e=await this.axiosInstance.get("/user/real-estate/records");return e.data}async getQueryRecordDetail(e){let t=await this.axiosInstance.get("/user/real-estate/records/".concat(e));return t.data}async getQueryRecordFiles(e){let t=await this.axiosInstance.get("/user/real-estate/records/".concat(e,"/files"));return t.data}constructor(){this.axiosInstance=n.Z.create({baseURL:"http://localhost:8080/yunkeji/api",timeout:1e4,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{let t=a.Z.get("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(a.Z.remove("token"),window.location.href="/login"),Promise.reject(e)})}}},22173:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return QueryPage}});var n=s(57437),a=s(2265),r=s(88110),i=s.n(r),l=s(28170),o=s(79404),u=s(43574),c=s(65137),d=s(33116),h=s(20020),m=s(18142),p=s(35302),x=s(13405),y=s(80338),f=s(46613),g=s(24033),j=s(65126),Z=s(13689);let{Title:k}=p.default,{Step:w}=x.default;function QueryPage(){let[e,t]=(0,a.useState)(0),[s]=o.Z.useForm(),[r,p]=(0,a.useState)([]),[w,b]=(0,a.useState)(!1),v=(0,g.useRouter)(),[I,T]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{T(!0),(0,Z.$8)()||v.push("/login")},[]),!I)return null;let onFinish=async e=>{b(!0);try{let t=new FormData,s={name:e.name,idCard:e.idCard};t.append("request",new Blob([JSON.stringify(s)],{type:"application/json"})),null==r||r.forEach(e=>{t.append("files",e.originFileObj)}),await j.Z.submitRealEstateQueryWithFiles(t),d.ZP.success("查询请求提交成功"),v.push("/dashboard")}catch(e){d.ZP.error("查询请求提交失败")}finally{b(!1)}},A=[{title:"填写信息",content:(0,n.jsxs)(o.Z,{form:s,layout:"vertical",onFinish:onFinish,children:[(0,n.jsx)(o.Z.Item,{label:"姓名",name:"name",rules:[{required:!0,message:"请输入姓名!"}],children:(0,n.jsx)(u.Z,{placeholder:"请输入被查询人姓名"})}),(0,n.jsx)(o.Z.Item,{label:"身份证号",name:"idCard",rules:[{required:!0,message:"请输入身份证号!"}],children:(0,n.jsx)(u.Z,{placeholder:"请输入被查询人身份证号"})}),(0,n.jsxs)(o.Z.Item,{label:"相关文件",name:"files",children:[(0,n.jsx)(c.Z,{fileList:r,onChange:e=>{let{fileList:t}=e;p(t)},multiple:!0,beforeUpload:()=>!1,children:(0,n.jsx)(i(),{icon:(0,n.jsx)(f.Z,{}),children:"选择文件"})}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("small",{children:"支持PDF、图片等文件格式"})})]}),(0,n.jsx)(o.Z.Item,{children:(0,n.jsxs)(y.ZP,{children:[(0,n.jsx)(i(),{type:"primary",htmlType:"submit",loading:w,children:"提交查询"}),(0,n.jsx)(i(),{onClick:()=>v.push("/dashboard"),children:"返回"})]})})]})}];return(0,n.jsx)("div",{className:"container",children:(0,n.jsx)(h.Z,{justify:"center",style:{marginTop:"30px"},children:(0,n.jsx)(m.Z,{xs:24,sm:20,md:16,lg:12,children:(0,n.jsxs)(l.Z,{children:[(0,n.jsx)(k,{level:3,style:{textAlign:"center"},children:"不动产信息查询"}),(0,n.jsx)(x.default,{current:e,items:A.map(e=>({title:e.title}))}),(0,n.jsx)("div",{style:{marginTop:24},children:A[e].content})]})})})})}},13689:function(e,t,s){"use strict";s.d(t,{$8:function(){return isAuthenticated},H6:function(){return removeAuthToken},uB:function(){return setAuthToken}});var n=s(11490);let setAuthToken=e=>{n.Z.set("token",e,{expires:7})},getAuthToken=()=>n.Z.get("token"),removeAuthToken=()=>{n.Z.remove("token")},isAuthenticated=()=>!!getAuthToken()}},function(e){e.O(0,[890,284,594,140,892,541,971,472,744],function(){return e(e.s=78929)}),_N_E=e.O()}]);