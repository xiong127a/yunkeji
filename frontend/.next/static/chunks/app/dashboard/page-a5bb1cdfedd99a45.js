(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{90362:function(e,t,s){Promise.resolve().then(s.bind(s,56086))},65126:function(e,t,s){"use strict";var r=s(54829),n=s(11490);t.Z=new class{async login(e,t){let s=await this.axiosInstance.post("/auth/login",{username:e,password:t});return s.data}async register(e,t,s){let r=await this.axiosInstance.post("/auth/register",{username:e,email:t,password:s});return r.data}async submitRealEstateQuery(e){let t=await this.axiosInstance.post("/user/real-estate/query",e);return t.data}async submitRealEstateQueryWithFiles(e){let t=await this.axiosInstance.post("/user/real-estate/query-with-files",e,{headers:{"Content-Type":"multipart/form-data"}});return t.data}async queryRealEstateResult(e){let t=await this.axiosInstance.get("/user/real-estate/result/".concat(e));return t.data}async getUserQueryRecords(){let e=await this.axiosInstance.get("/user/real-estate/records");return e.data}async getQueryRecordDetail(e){let t=await this.axiosInstance.get("/user/real-estate/records/".concat(e));return t.data}async getQueryRecordFiles(e){let t=await this.axiosInstance.get("/user/real-estate/records/".concat(e,"/files"));return t.data}constructor(){this.axiosInstance=r.Z.create({baseURL:"http://localhost:8080/yunkeji/api",timeout:1e4,headers:{"Content-Type":"application/json"}}),this.axiosInstance.interceptors.request.use(e=>{let t=n.Z.get("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(n.Z.remove("token"),window.location.href="/login"),Promise.reject(e)})}}},56086:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Dashboard}});var r=s(57437),n=s(2265),a=s(88110),i=s.n(a),c=s(28170),o=s(89158),l=s(33116),u=s(20020),d=s(18142),h=s(35302),x=s(80338),y=s(24033),j=s(61396),p=s.n(j),g=s(16691),f=s.n(g),m=s(65126),Z=s(13689);let{Title:k,Text:v}=h.default;function Dashboard(){let[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),h=(0,y.useRouter)();(0,n.useEffect)(()=>{if(!(0,Z.$8)()){h.push("/login");return}fetchRecords()},[]);let fetchRecords=async()=>{try{let e=await m.Z.getUserQueryRecords();t(e)}catch(e){l.ZP.error("获取查询记录失败")}finally{a(!1)}},getStatusText=e=>{switch(e){case"SUBMITTED":return"已提交";case"PROCESSING":return"处理中";case"COMPLETED":return"已完成";default:return e}};return(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)(u.Z,{justify:"center",style:{marginTop:"30px"},children:(0,r.jsx)(d.Z,{span:24,children:(0,r.jsx)(c.Z,{children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)("div",{children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)(f(),{src:"/yunkeji-logo.jpg",alt:"云科技Logo",width:50,height:50,style:{borderRadius:"4px",marginRight:"10px"}}),(0,r.jsx)(k,{level:3,style:{margin:0},children:"控制台"})]})}),(0,r.jsxs)(x.ZP,{children:[(0,r.jsx)(i(),{type:"primary",children:(0,r.jsx)(p(),{href:"/query",children:"新建查询"})}),(0,r.jsx)(i(),{onClick:()=>{(0,Z.H6)(),h.push("/login")},children:"退出登录"})]})]})})})}),(0,r.jsx)(u.Z,{justify:"center",style:{marginTop:"30px"},children:(0,r.jsx)(d.Z,{span:24,children:(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(k,{level:4,children:"我的查询记录"}),(0,r.jsx)(o.Z,{loading:s,dataSource:e,renderItem:e=>(0,r.jsxs)(o.Z.Item,{children:[(0,r.jsx)(o.Z.Item.Meta,{title:(0,r.jsxs)(p(),{href:"/query/".concat(e.id),children:[e.name," (",e.idCard,")"]}),description:(0,r.jsxs)(x.ZP,{children:[(0,r.jsxs)(v,{children:["状态: ",getStatusText(e.status)]}),(0,r.jsxs)(v,{children:["创建时间: ",e.createdAt]}),e.requestNo&&(0,r.jsxs)(v,{children:["请求编号: ",e.requestNo]})]})}),(0,r.jsx)("div",{children:(0,r.jsx)(p(),{href:"/query/".concat(e.id),children:(0,r.jsx)(i(),{type:"link",children:"查看详情"})})})]})}),0===e.length&&!s&&(0,r.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,r.jsx)(v,{children:"暂无查询记录"})})]})})})]})}},13689:function(e,t,s){"use strict";s.d(t,{$8:function(){return isAuthenticated},H6:function(){return removeAuthToken},uB:function(){return setAuthToken}});var r=s(11490);let setAuthToken=e=>{r.Z.set("token",e,{expires:7})},getAuthToken=()=>r.Z.get("token"),removeAuthToken=()=>{r.Z.remove("token")},isAuthenticated=()=>!!getAuthToken()}},function(e){e.O(0,[890,284,594,396,140,691,4,971,472,744],function(){return e(e.s=90362)}),_N_E=e.O()}]);